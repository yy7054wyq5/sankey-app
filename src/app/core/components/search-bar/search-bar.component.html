<form (submit)="search()">
  <!-- <h2 *ngIf="searchMode==='startEnd'">两个人之间有哪些关系</h2>
  <h2 *ngIf="searchMode==='onePoint'">他有哪些关系</h2> -->
  <nz-select [(ngModel)]="searchMode" name="value" nzPlaceHolder="请选择搜索模式" nzAllowClear>
    <nz-option *ngFor="let item of searchModes" [nzLabel]="item.label" [nzValue]="item.value"> </nz-option>
  </nz-select>

  <div [ngStyle]="{ display: searchMode === 'startEnd' ? 'block' : 'none' }">
    <!-- 选择起点 -->
    <nz-spin [nzSpinning]="startLoading">
      <nz-select
        class="search-point start-point"
        [nzServerSearch]="true"
        [nzDropdownClassName]="'search-bar-select'"
        nzShowSearch
        nzAllowClear
        nzPlaceHolder="Starting point"
        [(ngModel)]="start"
        name="start"
        (ngModelChange)="selected($event, 'start')"
        (nzOpenChange)="open($event)"
      >
        <ng-container *ngFor="let option of startOptions">
          <nz-option
            *ngIf="option['name']"
            nzLabel="{{option['name']}}&nbsp;{{option['c_name']}}&nbsp;{{option['p_title']}}"
            nzValue="{{option['p_id']}}"
            [nzCustomContent]="true"
          >
            <div class="option-label" (click)="getStartAndEndData(option, 'start')">
              <div class="name">{{ option.name }}</div>
              <div class="content">
                <div *ngFor="let item of option.info">
                  <span class="company">{{ item.c_name }}</span> <span class="last">{{ lastOptionLable(item) }}</span>
                </div>
              </div>
            </div>
          </nz-option>
        </ng-container>
      </nz-select>
    </nz-spin>

    <!-- 选择终点 -->
    <nz-spin [nzSpinning]="endLoading">
      <nz-select
        class="search-point end-point"
        [nzServerSearch]="true"
        [nzDropdownClassName]="'search-bar-select'"
        nzShowSearch
        nzAllowClear
        nzPlaceHolder="Ending point"
        [(ngModel)]="end"
        name="end"
        (ngModelChange)="selected($event, 'end')"
        (nzOpenChange)="open($event)"
      >
        <ng-container *ngFor="let option of endOptions">
          <nz-option
            *ngIf="option['name']"
            nzLabel="{{option['name']}}&nbsp;{{option['c_name']}}&nbsp;{{option['p_title']}}"
            nzValue="{{option['p_id']}}"
            [nzCustomContent]="true"
          >
            <div class="option-label" (click)="getStartAndEndData(option, 'end')">
              <div class="name">{{ option.name }}</div>
              <div class="content">
                <div *ngFor="let info of option.info">
                  <span class="company">{{ info.c_name }}</span> <span class="last">{{ lastOptionLable(info) }}</span>
                </div>
              </div>
            </div>
          </nz-option>
        </ng-container>
      </nz-select>
    </nz-spin>
  </div>

  <div [ngStyle]="{ display: searchMode === 'onePoint' ? 'block' : 'none' }">
    <nz-spin [nzSpinning]="onePointLoading">
      <nz-select
        class="search-point one-point"
        [nzServerSearch]="true"
        [nzDropdownClassName]="'search-bar-select'"
        nzShowSearch
        nzAllowClear
        nzPlaceHolder="Starting point"
        [(ngModel)]="onePoint"
        name="onePoint"
        (ngModelChange)="selected($event, 'end')"
        (nzOpenChange)="open($event)"
      >
        <ng-container *ngFor="let option of onePointOptions">
          <nz-option
            *ngIf="option['name']"
            nzLabel="{{option['name']}}&nbsp;{{option['c_name']}}&nbsp;{{option['p_title']}}"
            nzValue="{{option['p_id']}}"
            [nzCustomContent]="true"
          >
            <div class="option-label" (click)="getStartAndEndData(option, 'end')">
              <div class="name">{{ option.name }}</div>
              <div class="content">
                <div *ngFor="let info of option.info">
                  <span class="company">{{ info.c_name }}</span> <span class="last">{{ lastOptionLable(info) }}</span>
                </div>
              </div>
            </div>
          </nz-option>
        </ng-container>
      </nz-select>
    </nz-spin>
  </div>

  <!-- 匹配 -->
  <button class="match-btn" nz-button [nzType]="'primary'" type="submit">Match</button>

  <ng-container *ngIf="degrees">
  <!-- <ng-container> -->
    <app-collapse class="collapse" colIcon="icon-filter" colTitle="Filters" [colIsCollapse]="false">
      <div class="filter">
        <h5>Degree level</h5>
        <nz-checkbox-group name="degree" [(ngModel)]="degrees" (ngModelChange)="UI_outCheckedDegrees($event)"></nz-checkbox-group>
        <h5>Number of chains</h5>
        <nz-slider [nzStep]="null" [nzIncluded]="false" name="chains" (ngModelChange)="UI_outCrtMark('chains', $event)" [(ngModel)]="sliderChains.value"  [nzMarks]="sliderChains.marks" [nzMax]="sliderChains.max" [nzMin]="sliderChains.min"></nz-slider>
        <h5>Timeline</h5>
        <nz-slider [nzStep]="null" name="timeline" (ngModelChange)="UI_outCrtMark('timelines', $event)" [(ngModel)]="sliderTimelines.value"  [nzMarks]="sliderTimelines.marks" [nzDefaultValue]="sliderTimelines.max"  [nzMax]="sliderTimelines.max" [nzMin]="sliderTimelines.min"></nz-slider>
        <h5>Strength</h5>
        <nz-slider [nzStep]="null" [nzRange]="true" name="strength" (ngModelChange)="UI_outCrtMark('strength', $event)" [nzMarks]="sliderStrength.marks" [(ngModel)]="sliderStrength.value" [nzMax]="sliderStrength.max" [nzMin]="sliderStrength.min"></nz-slider>
      </div>
    </app-collapse>
  </ng-container>

  <ng-container *ngIf="records.data">
    <app-collapse class="collapse" colIcon="icon-history" colTitle="History" [colIsCollapse]="false">
      <ul class="histores ">
        <li *ngFor="let history of records.data" (click)="search(history)">
          {{ history.start['company'] }}/{{ history.start['name'] }}->{{ history.end['company'] }}/{{ history.end['name'] }}
        </li>
      </ul>
      <div class="clear-history " *ngIf="records.data.length ">
        <!-- <i class="icon delete"></i> -->
        <span (click)="clearRecords()">清空历史</span>
      </div>
    </app-collapse>
  </ng-container>

  <!-- 引导 -->
  <div class="search-tips">
    <img src="/assets/images/arrow-guide.png" alt="" />
    <div>请输入您的关键字，以“空格”隔开</div>
  </div>
</form>
